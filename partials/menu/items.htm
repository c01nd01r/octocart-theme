{% for category in categories %}
    {% set productCount = category.product_count %}
    <li class="cat-item  cat-item-{{ category.id }} {% if category.slug == currentCategorySlug %}current-cat{% endif %}">
        <a href="{{ category.url }}">{{ category.title }}</a>
        {% if productCount %}
            <span class="badge">{{ productCount }}</span>
        {% endif %}

        {% if category.children.count %}
            <ul>
                {% partial __SELF__ ~ "::items"
                    categories=category.children
                    currentCategorySlug=currentCategorySlug
                %}
            </ul>
        {% endif %}
    </li>
{% endfor %}
